<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>검색 결과</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .loading { font-size: 18px; }
    .results { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
    .card {
      border: 1px solid #ddd; border-radius: 8px; padding: 10px;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.1);
    }
    .card img { width: 100%; height: 150px; object-fit: cover; border-radius: 4px; }
    .card-title { font-weight: bold; margin: 10px 0 5px; }
    .card-price { color: green; margin-bottom: 10px; }
    .card a { text-decoration: none; color: #0066cc; }
  </style>
</head>
<body>

<h2>🔍 검색 결과</h2>
<p class="loading">잠시만 기다려주세요... 결과를 불러오는 중입니다.</p>
<div class="results" id="results"></div>

<script>
  const query = new URLSearchParams(window.location.search).get("query");

  fetch(`/api/search?query=${encodeURIComponent(query)}`)
    .then(res => res.json())
    .then(data => {
      document.querySelector(".loading").style.display = "none";
      const container = document.getElementById("results");

      if (data.length === 0) {
        container.innerHTML = "<p>결과가 없습니다 😢</p>";
        return;
      }

      data.forEach(item => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${item.image}" alt="${item.title}">
          <div class="card-title">${item.title}</div>
          <div class="card-price">${item.price}</div>
          <a href="${item.link}" target="_blank">상품 보기</a>
        `;
        container.appendChild(card);
      });
    })
    .catch(err => {
      console.error("❌ API 오류:", err);
      document.querySelector(".loading").innerText = "오류가 발생했습니다. 나중에 다시 시도해주세요.";
    });
</script>

</body>
</html>

